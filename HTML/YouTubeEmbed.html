<html>
<head>
    <meta content='IE=Edge' http-equiv='X-UA-Compatible' />
    <script>function popWebMessageBox(message) { alert(message); }</script>
</head>
<body>
    <script type='text/javascript' src='http://www.youtube.com/player_api'></script>
    <iframe id="ik_player_iframe" src='http://www.youtube.com/embed/Z25ibgtwQa0?autoplay=1&controls=1&enablejsapi=1' width='100%' height='650' frameborder='0' allowfullscreen='allowfullscreen' style='border: solid 10px #37474F'></iframe>
    <script type='text/javascript'>



        // 3. This function creates an <iframe> (and YouTube player)
        //    after the API code downloads.
        var player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('ik_player_iframe', {
                height: '390',
                width: '640',
                videoId: 'M7lc1UVf-VE',
                playerVars: { 'autoplay': 1, 'controls': 0 },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            document.getElementById('ik_player_iframe').style.borderColor = '#FF6D00';
            window.external.PopWinFormsMessageBox('Video finished!!');
            event.target.playVideo();
        }

        function stopVideo() {
            player.stopVideo();
        }


        function onPlayerStateChange(event) {
            changeBorderColor(event.data);
            switch (event.data) {
                case YT.PlayerState.UNSTARTED:
                    console.log('unstarted');
                    break;
                case YT.PlayerState.ENDED:
                    console.log('ended');
                    window.external.PopWinFormsMessageBox('Video finished!!');
                    break;
                case YT.PlayerState.PLAYING:
                    console.log('playing');
                    break;
                case YT.PlayerState.PAUSED:
                    console.log('paused');
                    break;
                case YT.PlayerState.BUFFERING:
                    console.log('buffering');
                    break;
                case YT.PlayerState.CUED:
                    console.log('video cued');
                    break;
            }
        }

        function changeBorderColor(playerStatus) {
            var color;
            if (playerStatus == -1) {
                color = "#37474F"; // unstarted = gray
            } else if (playerStatus == 0) {
                color = "#FFFF00"; // ended = yellow
            } else if (playerStatus == 1) {
                color = "#33691E"; // playing = green
            } else if (playerStatus == 2) {
                color = "#DD2C00"; // paused = red
            } else if (playerStatus == 3) {
                color = "#AA00FF"; // buffering = purple
            } else if (playerStatus == 5) {
                color = "#FF6DOO"; // video cued = orange
            }
            if (color) {
                document.getElementById('ik_player_iframe').style.borderColor = color;
            }
        }



    </script>
</body>
</html>